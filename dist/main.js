(()=>{var t={431:t=>{"use strict";t.exports=JSON.parse('{"place":"London","start_date":"2021-1-6","end_date":"2021-1-13","image_url":"https://pixabay.com/get/51e3d4414b51b10ff3d8992cc6213278123adaed4e5077497c2f7cdc974bc4_640.jpg","weather":[{"valid_date":"2021-01-06","max_temp":8.4,"min_temp":3.9,"precip":2.625,"wind_spd":2.85076},{"valid_date":"2021-01-07","max_temp":9.7,"min_temp":5.1,"precip":1,"wind_spd":3.74496},{"valid_date":"2021-01-08","max_temp":10.8,"min_temp":7,"precip":3.1875,"wind_spd":4.09435},{"valid_date":"2021-01-09","max_temp":13.2,"min_temp":7.9,"precip":2.4375,"wind_spd":5.08073},{"valid_date":"2021-01-10","max_temp":13,"min_temp":8.6,"precip":3.9375,"wind_spd":6.45203},{"valid_date":"2021-01-11","max_temp":10.2,"min_temp":6.1,"precip":0.3125,"wind_spd":6.41817},{"valid_date":"2021-01-12","max_temp":6.1,"min_temp":6.1,"precip":0,"wind_spd":6.71427}]}')},124:t=>{"use strict";t.exports=JSON.parse('{"id":3,"data":{"1":{"place":"Paris","start_date":"2020-12-28","end_date":"2021-1-1","image_url":"https://pixabay.com/get/57e0d74b4e52b10ff3d8992cc6213278123adaed4e5077497c2f7cdc9044cc_640.jpg","weather":[{"valid_date":"2020-12-28","max_temp":6.7,"min_temp":3.1,"precip":0.363281,"wind_spd":2.40659},{"valid_date":"2020-12-29","max_temp":6.1,"min_temp":2.6,"precip":1.22266,"wind_spd":2.72416},{"valid_date":"2020-12-30","max_temp":4.8,"min_temp":1.6,"precip":0.1875,"wind_spd":1.62015},{"valid_date":"2020-12-31","max_temp":4.8,"min_temp":1.2,"precip":0,"wind_spd":1.68323}]},"2":{"place":"New York City","start_date":"2021-1-1","end_date":"2021-1-6","image_url":"https://pixabay.com/get/55e3d3474d57b10ff3d8992cc6213278123adaed4e5077497c2f7cd39e49c6_640.jpg","weather":[{"valid_date":"2021-01-01","max_temp":11.2,"min_temp":2.3,"precip":53.4375,"wind_spd":6.26746},{"valid_date":"2021-01-02","max_temp":11.7,"min_temp":5.8,"precip":1.25,"wind_spd":4.44662},{"valid_date":"2021-01-03","max_temp":5.8,"min_temp":0.9,"precip":0,"wind_spd":6.5735},{"valid_date":"2021-01-04","max_temp":2.1,"min_temp":-0.6,"precip":0,"wind_spd":4.80079},{"valid_date":"2021-01-05","max_temp":3.4,"min_temp":-0.8,"precip":0,"wind_spd":2.57675}]},"3":{"place":"London","start_date":"2021-1-6","end_date":"2021-1-13","image_url":"https://pixabay.com/get/51e3d4414b51b10ff3d8992cc6213278123adaed4e5077497c2f7cdc974bc4_640.jpg","weather":[{"valid_date":"2021-01-06","max_temp":8.4,"min_temp":3.9,"precip":2.625,"wind_spd":2.85076},{"valid_date":"2021-01-07","max_temp":9.7,"min_temp":5.1,"precip":1,"wind_spd":3.74496},{"valid_date":"2021-01-08","max_temp":10.8,"min_temp":7,"precip":3.1875,"wind_spd":4.09435},{"valid_date":"2021-01-09","max_temp":13.2,"min_temp":7.9,"precip":2.4375,"wind_spd":5.08073},{"valid_date":"2021-01-10","max_temp":13,"min_temp":8.6,"precip":3.9375,"wind_spd":6.45203},{"valid_date":"2021-01-11","max_temp":10.2,"min_temp":6.1,"precip":0.3125,"wind_spd":6.41817},{"valid_date":"2021-01-12","max_temp":6.1,"min_temp":6.1,"precip":0,"wind_spd":6.71427}]}}}')},940:(t,e,a)=>{let i=a(431);t.exports={Api:class{constructor(){this.url="/trip"}async get(){return i}async post(t){let e=await fetch(this.url,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)});return await e.json()}}}},92:(t,e,a)=>{let{Modal:i}=a(986),{Form:s}=a(272),{Api:n}=a(940),{Planning:d}=a(629),{Storage:r}=a(476),{Table:p}=a(224);t.exports={App:class{constructor(){this.api=new n(this),this.storage=new r(this),this.modal=new i(this),this.form=new s(this),this.planning=new d(this),this.table=new p(this)}}}},272:t=>{t.exports={Form:class{constructor(t){this.app=t,this.fields=["place","start_date","end_date"],this.$form=document.getElementById("form"),this.$inputs=this.fields.reduce(((t,e)=>(t[e]=document.getElementById(e),t)),{}),this.$form.addEventListener("submit",this.handleSubmit.bind(this))}getObj(){return this.fields.reduce(((t,e)=>(t[e]=this.$inputs[e].value,t)),{})}async handleSubmit(t){t.preventDefault();let e=this.getObj(),a=await this.app.api.post(e);if(!a.err){let t=this.app.storage.getNewTrip(a);await this.app.planning.updateRender(t)}this.app.modal.hideModel()}}}},986:t=>{t.exports={Modal:class{constructor(t){this.app=t,this.$modal=document.getElementById("myModal"),this.$btn=document.getElementById("myBtn"),this.$span=document.getElementsByClassName("close")[0],this.$btn.addEventListener("click",this.showModel.bind(this)),this.$span.addEventListener("click",this.hideModel.bind(this))}showModel(){this.$modal.style.display="block"}hideModel(){this.$modal.style.display="none"}}}},629:(t,e,a)=>{let{Infos:i}=a(331),{Charts:s}=a(434);t.exports={Planning:class{constructor(t){this._data={},this.app=t,this.infos=new i(this),this.charts=new s(this),this._details=["place","start_date","end_date"],this._fields=["image_url",...this._details,"weather"],this.$planning=document.getElementById("planning");let e=this.app.storage.getall();e.length>0&&this.updateRender(e[0])}clean(t){for(let e of this._fields)if(void 0===t[e])return!1;return!0}save(){if(!0===this._data.notsaved){this._data.notsaved=!1;let t=this._fields.reduce(((t,e)=>(t[e]=this._data[e],t)),{});this.app.storage.create(t),this._data.notsaved=!1,this.app.table.render(),this.updateRender(this._data)}}update(t){this.clean(t)&&(this._data=t,this.charts.display="temp")}html(){return`\n      <div class="label title">Trip Planning Results</div>\n      ${this.infos.html()}\n      ${this.charts.html()}\n    `}render(){let t;this.clean(this._data)?(this.$planning.innerHTML="",t=this.html(),this.$planning.innerHTML=t,this.infos.event(),this.charts.event(),this.charts.render()):(t='\n      <div class="infos">\n        <div class="no_data">\n          No Data Available\n        </div>\n      </div>\n      <div class="chart">\n        <canvas id="myChart"></canvas>\n      </div>\n      ',this.$planning.innerHTML=t)}async updateRender(t){this.update(t),this.render()}}}},476:(t,e,a)=>{let i=a(124);t.exports={Storage:class{constructor(){let t=window.localStorage.getItem("trips");null===t&&(t=JSON.stringify(i),window.localStorage.setItem("trips",t)),this.storage=JSON.parse(t)}getState({start_date:t,end_date:e}){let a,i,s=new Date,n=new Date(t),d=new Date(e),r=864e5;if(n.getTime()-s.getTime()>0){let t=Math.ceil((n.getTime()-s.getTime())/r);i="green",a=0===t?"less than one day to start":1===t?"one day to start":`${t} days to start`}else if(d.getTime()-s.getTime()>0){i="orange";let t=Math.floor((s.getTime()-n.getTime())/r);a=0===t?"started less than one day ago":1===t?"started one day ago":`started ${t} days ago`}else{i="red";let t=Math.floor((s.getTime()-d.getTime())/r);a=0===t?"finished less than one day ago":1===t?"finished one day ago":`finished ${t} days ago`}return{state:a,color:i}}getNewTrip(t){return{...t,...this.getState(t),notsaved:!0}}create(t){this.storage.id=this.storage.id+1;let e=this.storage.id;this.storage.data[e]=t,window.localStorage.setItem("trips",JSON.stringify(this.storage))}getall(){return Object.keys(this.storage.data).sort(((t,e)=>parseInt(e)-parseInt(t))).map((t=>({id:t,...this.storage.data[t],...this.getState(this.storage.data[t])})))}get(t){let e=this.storage.data[t];return{...e,...this.getState(e)}}delete(t){delete this.storage.data[t],window.localStorage.setItem("trips",JSON.stringify(this.storage))}}}},224:t=>{t.exports={Table:class{constructor(t){this.app=t,this.data=[],this.$tbody=document.getElementById("tbody"),this.render()}html(){return 0===this.data.length?'\n            <tr>\n              <td colspan="3">no trips available</td>\n            </tr>':this.data.map((t=>`\n        <tr>\n            <td>${t.place}</td>\n            <td style='color: ${t.color};font-weight:bold'>\n                ${t.state}\n            </td>\n            <td>\n            <button class="view" data-id="${t.id}"></button>\n            <button class="delete" data-id="${t.id}"></button>\n            </td>\n        </tr>\n        `)).join("")}event(){document.querySelectorAll(".view").forEach((t=>t.addEventListener("click",(t=>{let e=t.target.getAttribute("data-id"),a=this.app.storage.get(e);this.app.planning.updateRender(a)})))),document.querySelectorAll(".delete").forEach((t=>t.addEventListener("click",(t=>{let e=t.target.getAttribute("data-id");this.app.storage.delete(e),this.render()}))))}render(){this.$tbody.innerHTML="",this.data=this.app.storage.getall(),this.$tbody.innerHTML=this.html(),this.event()}}}},434:t=>{t.exports={Charts:class{constructor(t){this.planning=t,this.display="temp"}event(){let t=document.getElementById("display"),e=document.getElementById("chart");t.onchange=t=>{e.innerHTML="",this.display=t.target.value,e.innerHTML='<canvas id="myChart"></canvas>',this.render()}}chartData(){let t=this.planning._data.weather,e={};return e.temp={type:"line",data:{labels:t.map((t=>t.valid_date)),datasets:[{label:"Maximum Temperature (Celcius)",borderColor:"rgb(220,20,60)",fill:!1,data:t.map((t=>t.max_temp)),type:"line"},{label:"Minimum Temperature (Celcius)",borderColor:"rgb(0,255,255)",fill:!1,data:t.map((t=>t.min_temp)),type:"line"}]},options:{}},e.prep={type:"bar",data:{labels:t.map((t=>t.valid_date)),datasets:[{label:"Accumulated precipitation (mm)",backgroundColor:"blue",data:t.map((t=>t.precip))}]},options:{legend:{display:!1},title:{display:!0,text:"Accumulated precipitation (mm)"}}},e.wind_spd={type:"line",data:{labels:t.map((t=>t.valid_date)),datasets:[{label:"Wind speed  (m/s)",borderColor:"rgb(243,126,48)",fill:!1,data:t.map((t=>t.wind_spd)),type:"line"}]},options:{}},e}html(){return'\n      <div class="weather">\n        <select id="display" name="display">\n          <option value="temp">Temperature</option>\n          <option value="prep">Precipitation</option>\n          <option value="wind_spd">Wind</option>\n        </select>\n        <div id="chart" class="chart">\n          <canvas id="myChart"></canvas>\n        </div>\n      </div>\n      '}render(){let t=document.getElementById("myChart");if(void 0!==t&&null!=t){var e=document.getElementById("myChart").getContext("2d");new Chart(e,this.chartData()[this.display])}}}}},331:t=>{t.exports={Infos:class{constructor(t){this.planning=t}event(){let t=document.getElementById("infos_img");t.onerror=()=>{t.onerror=null,t.src="/images/noimage.png"};let e=document.querySelectorAll("#save");e.length>0&&e[0].addEventListener("click",(t=>{this.planning.save()}))}html(){let t=this.planning._data;return`\n    <div class="infos">\n      <div class="image">\n        <img \n          id="infos_img"\n          src="${t.image_url}"\n           />\n      </div>\n      <div class="details">\n        <div  class="name">My trip to: <span id="dt-place">${t.place}</span></div>\n        <div  class="time">Departing: <span id="dt-start_date">${t.start_date}</span></div>\n        <div  class="time">Ending: <span id="dt-end_date">${t.end_date}</span></div>\n        <div  class="time">State: <span id="dt-state">${t.state}</span></div>\n        ${!0===t.notsaved?"<div><button class='save' id='save'>save trip</button></div>":""}\n      </div>\n    </div>\n    `}}}}},e={};function a(i){if(e[i])return e[i].exports;var s=e[i]={exports:{}};return t[i](s,s.exports,a),s.exports}a.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},a.d=(t,e)=>{for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=a(92);window.app=new t.App})()})();